<div class="wrapper">
  <section id="container">
    <div class="center-align">
      <a class="waves-effect waves-light btn green" (click)="generatePdf()">{{"EXPORT_PDF" | translate}}</a>
    </div>
    <div class="center-align">
      <a *ngIf="isAuthor || isAdmin" class="waves-effect waves-light btn green"
         [routerLink]="['../../update/', instruction.id]">{{"EDITING" | translate}}</a>
    </div>
    <div id="update-instruction-page" class="section">
      <div id="update-instruction-page-content" class="row">
          <div class="label col s12 m8">
            {{instruction.name}}
          </div>
        <div class="label col s12 m4">
          {{instruction.category.name}}
        </div>
      </div>
      <div class="row">
        <div id="tags" class="center col s12 m8">
          <div class="chip" *ngFor="let tag of this.instruction.tags">{{tag.name}}</div>
        </div>
      </div>
      <ul class="collapsible popout" data-collapsible="expandable">
        <li *ngFor="let step of this.instruction.steps; let i = index">
          <div class="collapsible-header blue lighten-4">
            <div class="row">
              <div class="label">
                {{step.name}}
              </div>
            </div>
          </div>
          <div class="collapsible-body">
            <ul class="collection">
              <li class="collection-item" *ngFor="let part of step.parts; let i = index">
                <div class="row">
                  <markdown *ngIf="part.type == 'TYPE_TEXT'" class="label">{{part.data}}</markdown>

                  <div *ngIf="part.type == 'TYPE_IMAGE'">
                    <div class="col s12 m2">
                      <div class="delimeter"></div>
                      <a class="waves-effect waves-light btn-floating btn-large orange"
                         (click)="addFilter('', part)">
                        <i class="large material-icons">filter</i>
                      </a>
                      <div class="delimeter"></div>
                      <a class="waves-effect waves-light btn-floating btn-large grey"
                         (click)="addFilter('e_grayscale', part)">
                        <i class="large material-icons">filter_1</i>
                      </a>
                      <div class="delimeter"></div>
                      <a class="waves-effect waves-light btn-floating btn-large green"
                         (click)="addFilter('e_improve', part)">
                        <i class="large material-icons">filter_2</i>
                      </a>
                      <div class="delimeter"></div>
                      <a class="waves-effect waves-light btn-floating btn-large blue"
                         (click)="addFilter('e_art:primavera', part)">
                        <i class="large material-icons">filter_3</i>
                      </a>
                    </div>
                    <div class="center col s12 m8">
                      <img width="700" [src]="makeLinkToImg(part.data)">
                    </div>
                  </div>

                  <div *ngIf="part.type == 'TYPE_VIDEO'" class="center">
                    <youtube-player [videoId]="part.data" [width]="640" [height]="480"
                    ></youtube-player>
                  </div>
                </div>
              </li>
            </ul>
            <div class="flex-container" fxLayoutAlign="center" fxLayout="column">
              <div [hidden]="!auth" class="flex-item">
                <div class="input-field col s8 m10">
                  <i class="material-icons prefix">mode_edit</i>
                  <textarea [(ngModel)]="comment" id="comment" class="validate materialize-textarea"
                            data-length="5"></textarea>
                  <label for="comment" data-error="max length 5000 symbols">Comment</label>
                </div>
                <div class="col s4 m2">
                  <button class="btn btn-primary" (click)="createComment(comment, i)">
                    <i class="material-icons">send</i>
                  </button>
                </div>
              </div>
              <div class="flex-item" *ngFor="let comment of comments[i]; let j = index"
                   id="comment{{comment.id}}">
                <md-card>
                  <md-card-header>
                    <div class="row" style="width: 100%;padding-right: 15px">
                      <div style="float: right;color: darkgrey">{{comment.creationDate | date:'medium'}}</div>
                    </div>
                    <md-card-title style="font-size: 20px">
                      {{comment.user.firstName}}
                      <div [hidden]="!isAdmin">
                        <a class="waves-effect waves-light btn-large blue"
                           (click)="deleteComment(comment, i)">
                          <i class="large material-icons">delete</i>
                        </a>
                      </div>
                    </md-card-title>
                  </md-card-header>
                  <md-card-content>
                    <div *ngIf="!comment.isEdit" style="padding: 10px 25px">
                      {{comment.text}}
                    </div>
                  </md-card-content>
                </md-card>
              </div>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </section>
</div>

<!--<div>-->
<!--<a class="waves-effect waves-light btn-floating btn-large yellow tooltipped"-->
<!--data-position="right" data-delay="50" data-tooltip="I am a tooltip">-->
<!--<i class="large material-icons">mode_edit</i>-->
<!--</a>-->
<!--</div>-->
